# Pixiv爬虫GUI版本使用说明

## 功能特性

- 🖼️ 图形化界面，操作简单直观
- 📊 实时显示爬取进度和日志
- ⚙️ 可配置爬取参数
- 🛑 支持中途停止爬取
- 📁 可视化选择保存路径

## 界面说明

### 布局设计
- **顶部功能栏**：功能区/设置/背景设置切换按钮
- **主要内容区**：功能配置和日志显示
- **窗口尺寸**：1300x900像素，支持调整大小
- **功能分区**：使用可折叠面板组织不同功能
- **日志区域**：占据右侧大部分空间，提供更好的日志查看体验
- **自定义背景**：支持预设主题和自定义图片背景

### 主要功能区域

#### 功能区面板

1. **相关推荐爬取**
   - 起始图片ID：输入要开始爬取的Pixiv图片ID
   - 最大深度：推荐算法的搜索深度（建议2-4）
   - 每轮图片数：每次获取的推荐图片数量
   - 保存路径：选择图片保存的本地目录

2. **日榜爬取**
   - 保存路径：选择日榜图片保存路径
   - 自动爬取Pixiv日榜作品

3. **热门作品爬取**
   - 标签：输入要搜索的标签（如"スズラン(アークナイツ)"）
   - 保存路径：选择热门图片保存路径
   - 功能：爬取指定标签的热门作品及其相关推荐

4. **画师作品爬取**
   - 画师ID：输入画师ID
   - 保存路径：选择画师作品保存路径
   - 功能：爬取指定画师的所有作品

#### 设置面板

1. **网络设置**
   - 代理端口：设置代理服务器端口
   - 连接超时：网络连接超时时间
   - 读取超时：数据读取超时时间
   - 重试次数：网络请求重试次数

2. **下载设置**
   - 下载线程数：并发下载线程数量
   - R-18下载开关：是否下载R-18内容
   - 漫画排除开关：是否排除漫画作品
   - 自动清理开关：是否自动清理.part文件
   - 进度显示开关：是否显示下载进度

3. **算法设置**
   - 最大深度：推荐算法搜索深度
   - 每轮图片数：每轮获取的图片数量
   - 推荐图片数：单次获取的推荐图片数量
   - 画师图片数：获取画师作品的数量

4. **路径设置**
   - 基础保存路径：所有下载文件的基础路径

#### 右侧状态面板

1. **状态显示**
   - 状态标签：显示当前运行状态
   - 进度条：显示爬取进度

2. **运行日志**
   - 实时显示爬取过程中的详细信息
   - 支持滚动查看历史日志
   - 使用等宽字体便于阅读
   - 占据右侧大部分空间，提供更好的查看体验
   - 支持35行显示，高度600像素

#### 控制功能
- **面板切换**：顶部功能栏可切换功能区、设置和背景设置面板
- **独立控制**：每个功能模块都有独立的开始/停止按钮
- **路径选择**：每个功能都有独立的路径选择按钮
- **状态管理**：运行时自动禁用其他功能，防止冲突
- **设置保存**：设置面板中的配置可以实时保存和应用
- **背景自定义**：支持多种预设主题和自定义图片背景

## 使用方法

### 1. 运行GUI应用

#### 在IDEA中运行（推荐）

**方法1：使用Maven插件**
1. 打开IDEA的Maven工具窗口（右侧）
2. 展开项目 → Plugins → javafx
3. 双击 `javafx:run`

**方法1.5：使用批处理脚本（推荐，解决编码问题）**
1. 双击 `run_gui.bat` 文件
2. 脚本会自动设置正确的编码并启动GUI

**方法2：直接运行启动器类**
1. 找到 `com.pixiv.crawler.gui.Launcher` 类
2. 右键点击 → Run 'Launcher.main()'

**方法3：配置运行参数**
1. 点击右上角运行配置 → Edit Configurations
2. 点击 `+` → Application
3. 配置：
   - **Main class:** `com.pixiv.crawler.gui.PixivCrawlerGUI`
   - **VM options:** `--module-path "C:\path\to\javafx-sdk-21.0.2\lib" --add-modules javafx.controls,javafx.fxml`

#### 命令行运行

```bash
# 方法1：使用Maven运行
mvn javafx:run

# 方法2：直接运行jar文件
java -jar target/crawler-1.0-SNAPSHOT.jar
```

### 2. 配置参数

#### 功能区配置
**相关推荐爬取**
1. 输入起始图片ID（从Pixiv图片URL中获取）
2. 设置最大深度（推荐2-4层）
3. 设置每轮图片数（推荐3-5张）
4. 点击"选择路径"按钮选择保存目录

**日榜爬取**
1. 点击"选择路径"按钮选择日榜图片保存目录

**热门作品爬取**
1. 输入要搜索的标签（如"スズラン(アークナイツ)"）
2. 点击"选择路径"按钮选择保存目录

**画师作品爬取**
1. 输入画师ID
2. 点击"选择路径"按钮选择保存目录

#### 设置面板配置
1. 点击顶部"设置"按钮进入设置面板
2. 根据需要调整网络、下载、算法、路径等设置
3. 点击"保存设置"按钮应用配置

#### 背景设置配置
1. 点击顶部"背景设置"按钮进入背景设置面板
2. **预设背景**：选择默认渐变、蓝色主题、绿色主题、紫色主题或深色主题
3. **自定义图片**：点击"选择背景图片"按钮选择本地图片文件
4. **清除背景**：点击"清除背景图片"按钮恢复默认背景
5. 支持的图片格式：PNG、JPG、JPEG、GIF、BMP
6. **设置持久化**：所有背景设置会自动保存，下次启动时自动加载

### 3. 开始爬取

1. 选择要使用的功能模块
2. 点击对应的"开始"按钮
3. 观察右侧日志输出，了解爬取进度
4. 如需停止，点击对应的"停止"按钮

### 4. 功能特点

- **独立运行**：每个功能模块可以独立运行
- **实时日志**：右侧面板实时显示运行状态
- **进度显示**：进度条显示当前任务进度
- **错误处理**：自动显示错误信息并提示用户
- **界面美化**：支持多种预设主题和自定义背景图片
- **设置持久化**：背景设置自动保存，下次启动自动加载

## 打包为exe文件

### 环境要求

- Java 17或更高版本
- Maven 3.6或更高版本
- Windows操作系统

### 打包步骤

1. **运行打包脚本**
   ```bash
   package.bat
   ```

2. **手动打包命令**
   ```bash
   # 清理并编译
   mvn clean compile
   
   # 创建运行时镜像
   mvn jlink:jlink
   
   # 生成exe文件
   mvn jpackage:jpackage
   ```

3. **查找生成的exe文件**
   - 位置：`target/dist/`目录
   - 文件名：`PixivCrawler.exe`

## 注意事项

### 网络配置
- 确保已配置代理（默认127.0.0.1:7897）
- 确保网络连接正常

### 存储空间
- 爬取的图片可能占用大量存储空间
- 建议选择有足够空间的磁盘分区

### 爬取策略
- 建议从小深度开始测试
- 避免过于频繁的请求，以免被限制

## 故障排除

### 常见问题

1. **GUI无法启动**
   - 检查Java版本是否为17+
   - 检查Maven是否正确安装

2. **爬取失败**
   - 检查网络连接和代理设置
   - 查看日志中的具体错误信息

3. **exe文件无法运行**
   - 确保目标机器安装了Java运行时
   - 检查杀毒软件是否拦截

4. **中文显示乱码**
   - 使用提供的 `run_gui.bat` 脚本启动
   - 确保IDEA的编码设置为UTF-8
   - 检查系统区域设置

5. **日志不显示在GUI中**
   - 确保使用GUI日志处理器
   - 检查日志区域是否正确初始化

### 日志分析

GUI界面会显示详细的运行日志，包括：
- 网络请求状态
- 图片下载进度
- 错误信息
- 统计信息

### 日志系统特点
- **实时显示**：所有控制台输出都会实时显示在GUI日志区域
- **编码支持**：支持UTF-8编码，正确显示中文
- **自动滚动**：新日志会自动滚动到最底部
- **线程安全**：使用Platform.runLater确保线程安全

## 技术架构

- **GUI框架**：JavaFX 21
- **构建工具**：Maven
- **打包工具**：jpackage
- **基础框架**：Java 17

## 更新日志

### v1.1.1
- 添加背景设置持久化功能
- 背景设置自动保存到gui_settings.properties文件
- 程序启动时自动加载上次的背景设置
- 支持预设主题和自定义图片的持久化保存

### v1.1.0
- 添加自定义背景功能
- 支持5种预设主题背景
- 支持自定义图片背景
- 优化日志显示区域

### v1.0.0
- 初始GUI版本
- 支持基本的爬取功能
- 提供图形化配置界面
